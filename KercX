-- Подключаем WindUI
local WindUI = loadstring(game:HttpGet("https://github.com/Footagesus/WindUI/releases/latest/download/main.lua"))()

local Players = game:GetService("Players")
local UIS = game:GetService("UserInputService")
local RS = game:GetService("RunService")
local player = Players.LocalPlayer
local character = player.Character
local humanoid = character and character:FindFirstChildOfClass("Humanoid")
local hrp = character and character:FindFirstChild("HumanoidRootPart")

-- Обновляем при респавне
player.CharacterAdded:Connect(function(char)
    character = char
    humanoid = char:WaitForChild("Humanoid")
    hrp = char:WaitForChild("HumanoidRootPart")
end)

-- Создание окна
local Window = WindUI:CreateWindow({
    Title = "KercX GUI",
    Icon = "circle",
    Author = "KercX",
    Folder = "KercXGUI",
    Size = UDim2.fromOffset(500, 400),
    Transparent = false,
    Theme = "Dark",
    Resizable = true,
    Visible = true
})

-- TAB Player
local PlayerTab = Window:CreateTab({
    Title = "Player",
    Icon = "user",
    Visible = true
})

-- Speed
PlayerTab:CreateSlider({
    Title = "Speed",
    Description = "Измени скорость персонажа",
    Default = 16,
    Min = 16,
    Max = 200,
    Visible = true,
    Callback = function(value)
        if humanoid then humanoid.WalkSpeed = value end
    end
})

-- JumpPower
PlayerTab:CreateSlider({
    Title = "JumpPower",
    Description = "Измени высоту прыжка",
    Default = 50,
    Min = 50,
    Max = 500,
    Visible = true,
    Callback = function(value)
        if humanoid then humanoid.JumpPower = value end
    end
})

-- Noclip
local noclip = false
PlayerTab:CreateToggle({
    Title = "Noclip",
    Default = false,
    Visible = true,
    Callback = function(state) noclip = state end
})

-- Infinite Jump
local infiniteJump = false
PlayerTab:CreateToggle({
    Title = "Infinite Jump",
    Default = false,
    Visible = true,
    Callback = function(state) infiniteJump = state end
})

-- Fly
local flying = false
local flySpeed = 50
local flyUpDown = true
PlayerTab:CreateToggle({
    Title = "Fly",
    Default = false,
    Visible = true,
    Callback = function(state)
        flying = state
        if flying and hrp then humanoid.PlatformStand = true
        else humanoid.PlatformStand = false; if hrp then hrp.Velocity = Vector3.new(0,0,0) end
        end
    end
})

-- Toggle GUI
local guiVisible = true
PlayerTab:CreateToggle({
    Title = "Toggle GUI",
    Default = true,
    Visible = true,
    Callback = function(state)
        guiVisible = state
        Window:SetVisible(guiVisible)
    end
})

-- Управление полётом
local keys = {W=false, A=false, S=false, D=false, Space=false, LeftShift=false}
UIS.InputBegan:Connect(function(input, processed)
    if processed then return end
    if input.KeyCode == Enum.KeyCode.W then keys.W=true end
    if input.KeyCode == Enum.KeyCode.A then keys.A=true end
    if input.KeyCode == Enum.KeyCode.S then keys.S=true end
    if input.KeyCode == Enum.KeyCode.D then keys.D=true end
    if input.KeyCode == Enum.KeyCode.Space then keys.Space=true end
    if input.KeyCode == Enum.KeyCode.LeftShift then keys.LeftShift=true end
end)
UIS.InputEnded:Connect(function(input)
    if input.KeyCode == Enum.KeyCode.W then keys.W=false end
    if input.KeyCode == Enum.KeyCode.A then keys.A=false end
    if input.KeyCode == Enum.KeyCode.S then keys.S=false end
    if input.KeyCode == Enum.KeyCode.D then keys.D=false end
    if input.KeyCode == Enum.KeyCode.Space then keys.Space=false end
    if input.KeyCode == Enum.KeyCode.LeftShift then keys.LeftShift=false end
end)

-- Главный цикл
RS.Heartbeat:Connect(function()
    if character and hrp then
        -- Noclip
        if noclip then
            for _, part in pairs(character:GetChildren()) do
                if part:IsA("BasePart") then part.CanCollide=false end
            end
        end
        -- Fly
        if flying then
            local cam = workspace.CurrentCamera
            local move = Vector3.new(0,0,0)
            if keys.W then move = move + cam.CFrame.LookVector end
            if keys.S then move = move - cam.CFrame.LookVector end
            if keys.A then move = move - cam.CFrame.RightVector end
            if keys.D then move = move + cam.CFrame.RightVector end
            if flyUpDown then
                if keys.Space then move = move + Vector3.new(0,1,0) end
                if keys.LeftShift then move = move - Vector3.new(0,1,0) end
            end
            if move.Magnitude > 0 then hrp.Velocity = move.Unit * flySpeed else hrp.Velocity = Vector3.new(0,0,0) end
        end
    end
end)

-- Infinite Jump
UIS.JumpRequest:Connect(function()
    if infiniteJump and humanoid then humanoid:ChangeState(Enum.HumanoidStateType.Jumping) end
end)

-- Обеспечиваем видимость GUI
Window:SetVisible(true)
